{namespace tw=Tx_CwTwitter_ViewHelpers}
{namespace v=Tx_Vhs_ViewHelpers}
<t3jquery:addJQueryAndScript>
	/**
	 * replace the protocol of twitter images with the current protocol of the page
	 */
	jQuery(".twitter").
	jQuery(".twitter img").each(function(e) {jQuery(this).attr("src",jQuery(this).attr("src").replace("http:",location.protocol))})
	</t3jquery:addJQueryAndScript>

<f:layout name="Default"/>
<f:section name="main">
	<f:if condition="{tweets}">
		<f:then>
			<f:if condition="{contentObjectData.colPos} == 0"><!-- Hauptspalte -->
				<f:then>
					<div class="main twitter">
						<f:for each="{tweets}" as="orig_tweet">
							<f:alias map="{tweet: '{f:if(condition:orig_tweet.retweeted_status,then:orig_tweet.retweeted_status,else:orig_tweet)}'}">
								<div class="main__textblock">
									<a href="//twitter.com/{tweet.user.screen_name}"><img src="{tweet.user.profile_image_url}" alt="{tweet.user.name}"/>
										{tweet.user.name}</a>
									(<tw:link.tweet tweet="{tweet}"><f:format.date format="H:m - d.m.Y">{tweet.created_at}</f:format.date></tw:link.tweet>)
									<blockquote>
										<tw:format.tweet>{tweet}</tw:format.tweet>
										<f:if condition="{orig_tweet.retweeted_status}">
											<br /><img src="//si0.twimg.com/images/dev/cms/intents/icons/retweet.png" alt="Retweet"/>
											<f:translate key="tweetlist.retweeted_by"/>
											<a href="//twitter.com/{orig_tweet.user.screen_name}">{orig_tweet.user.name}</a>
										</f:if>
									</blockquote>
								</div>
							</f:alias>
						</f:for>
					</div>
					</div>
				</f:then>
				<f:else><!-- Seitenende oder Footer (oder Open-Access-Tage) -->
					<div class="main__textblock twitter">
						<f:for each="{tweets}" as="orig_tweet" iteration="iterator">
							<f:alias map="{tweet: '{f:if(condition:orig_tweet.retweeted_status,then:orig_tweet.retweeted_status,else:orig_tweet)}'}">
								<f:if condition="{iterator.index} < 2">
									<f:then>
										<p>
											<a href="//twitter.com/{tweet.user.screen_name}">
												<f:comment>
													The twitter extension provides two variables to load the images with:
													{tweet.user.profile_image_url} or {tweet.user.profile_image_url_https}
													therefore it has to be checked
												</f:comment>
												<f:if condition='{v:if.string.contains(then:"https:", else:"http:", haystack:"{v:site.url()}", needle:"https:")} == https'>
												<f:then>
													<img src="{tweet.user.profile_image_url}" alt="{tweet.user.name}"/> {tweet.user.name}</a>
													</f:then>
												<f:else>
													<img src="{tweet.user.profile_image_url_https}" alt="{tweet.user.name}"/> {tweet.user.name}</a>
													</f:else>
												</f:if>
											<br />
											<span class="text--small"><tw:link.tweet class="cwtw-TweetMeta-timestamp" tweet="{tweet}">
												<f:format.date format="H:m - d.m.Y">{tweet.created_at}</f:format.date>
											</tw:link.tweet></span>
											<br/>
											<tw:format.tweet>{tweet}</tw:format.tweet>
										</p>
									</f:then>
								</f:if>
							</f:alias>
						</f:for>
					</div>
				</f:else>
			</f:if>
		</f:then>
		<f:else>
			<f:if condition="{contentObjectData.colPos} == 0"><!-- Hauptspalte -->
				<f:then>
					<div class="main__textblock">
						<f:translate key="tweetlist.empty"/>
					</div>
				</f:then>
				<f:else>
					<div class="main__textblock">
						<f:translate key="tweetlist.empty"/>
					</div>
				</f:else>
			</f:if>
		</f:else>
	</f:if>
</f:section>